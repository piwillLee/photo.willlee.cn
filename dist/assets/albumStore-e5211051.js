var h=Object.defineProperty;var b=(e,t,s)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var m=(e,t,s)=>(b(e,typeof t!="symbol"?t+"":t,s),s);import{d}from"./pinia-fd6dbd4c.js";import{a as p}from"./axios-c47e0cf1.js";class l{constructor(t){m(this,"storage");this.storage=t===0?localStorage:sessionStorage}setCache(t,s){s&&this.storage.setItem(t,JSON.stringify(s))}getCache(t){const s=this.storage.getItem(t);if(s)return JSON.parse(s)}removeCache(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}const i=new l(0);new l(1);let c="";c="https://tbed.willlee.cn/api/v1";const I=1e4;class g{constructor(t){m(this,"instance");var s,u,n,r;this.instance=p.create(t),this.instance.interceptors.request.use(a=>a,a=>a),this.instance.interceptors.response.use(a=>a.data,a=>a),this.instance.interceptors.request.use((s=t.interceptors)==null?void 0:s.requestSuccessFn,(u=t.interceptors)==null?void 0:u.requestFailureFn),this.instance.interceptors.response.use((n=t.interceptors)==null?void 0:n.responseSuccessFn,(r=t.interceptors)==null?void 0:r.responseFailureFn)}request(t){var s;return(s=t.interceptors)!=null&&s.requestSuccessFn&&(t=t.interceptors.requestSuccessFn(t)),new Promise((u,n)=>{this.instance.request(t).then(r=>{var a;(a=t.interceptors)!=null&&a.responseSuccessFn&&(r=t.interceptors.responseSuccessFn(r)),u(r)}).catch(r=>{n(r)})})}get(t){return this.request({...t,method:"GET"})}post(t){return this.request({...t,method:"POST"})}delete(t){return this.request({...t,method:"DELETE"})}patch(t){return this.request({...t,method:"PATCH"})}}const o=new g({baseURL:c,timeout:I,interceptors:{requestSuccessFn:e=>{const t="1|JLJrErNHqGsyykxuVnURcBnaIa8HR29gwej47goU";return e.headers&&t&&(e.headers.Authorization="Bearer "+t),e}}});function L(){return o.get({url:"/albums"})}function A(e){return o.get({url:`/images?album_id=${e}`})}const C=d("ablum",{state:()=>({albumList:[],albumTotal:i.getCache("albumTotal"),albumsId:i.getCache("albumsId")??[],albumItemsList:i.getCache("albumItemsList")??[],isEnd:!1,defaultImg:new URL("@/assets/img/loading.png",self.location).href,currentAlbum:null}),actions:{async getAlbumAction(){const e=await L();this.albumTotal=e.data.total,this.albumList=e.data.data,this.albumList.forEach(s=>{this.albumsId.push(s.id)}),i.setCache("albumsId",this.albumsId),i.setCache("albumTotal",this.albumTotal),this.getAlbumItemArray(this.albumList);const t=new Date().getTime();i.setCache("firstGetTime",t)},async getAlbumItemAction(e){const t=await A(e);for(let s=0;s<this.albumList.length;s++)this.albumList[s].id==e&&(this.albumItemsList[s]={idData:this.albumList[s],itemData:t.data.data});i.setCache("albumItemsList",this.albumItemsList)},getAlbumItemArray(e){e.forEach(t=>{this.getAlbumItemAction(t.id)})},getAlbumData(){for(let e=0;e<this.albumList.length;e++)this.albumItemsList[e]={idData:this.albumList[e],itemData:this.albumItemsList[e]}},getAlbumById(e){this.albumItemsList.forEach(t=>{t.idData.id==e&&(this.currentAlbum=t)})}}});export{L as g,i as l,C as u};
